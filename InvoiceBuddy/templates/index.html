{% extends "base.html" %}
{% block content %}

<div id="delete_invoice_modal" tabindex="-1" class="modal fade" data-backdrop="static" xmlns="http://www.w3.org/1999/html">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Delete Invoice?</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete invoice "<span id="delete_invoice_modal_value"></span>"?</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button id="delete_invoice_modal_button" type="button" class="btn btn-primary">Yes</button>
            </div>
        </div>
    </div>
</div>

<div class="container p-0 mt-1">
    <div id="warning_notification" class="alert alert-warning ms-2 me-2 mb-0 text-danger" role="alert"
         style="display: none">
        <span><i class="bi bi-exclamation-triangle mb-2 me-2"></i><span id="warning_notification_message">This is the warning notification message placeholder</span></span>
    </div>
    <div id="success_notification" class="alert alert-success ms-2 me-2 mb-0" role="alert"
         style="display: none">
        <span><i class="bi bi-check-square mb-2 me-2"></i><span id="success_notification_message">This is the success notification message placeholder</span></span>
    </div>
</div>

<div class="container mt-4">
    <h2>Active Invoices (<span id="active_invoices_count_value"></span>)</h2>
    <div class="table-responsive">
        <table class="table table-striped" id="active_invoices_table">
            <thead class="thead-light">
            <tr>
                <th scope="col">Number</th>
                <th scope="col">Date</th>
                <th scope="col">Client</th>
                <th scope="col">Total Amount</th>
                <th scope="col">Actions</th>
            </tr>
            </thead>
            <tbody>

            </tbody>
            <tfoot style="border-top-width: thick;border-bottom-width: thick;">
            <tr>
                <td colspan="9"><b>Totals</b></td>
                <td><strong id="active_invoices_total_amount_value"></strong></td>
            </tr>
            </tfoot>
        </table>
    </div>
</div>

<div class="container mt-4">
    <h2>Active Proposals (<span id="active_proposals_count_value"></span>)</h2>
    <div class="table-responsive">
        <table class="table table-striped" id="active_proposals_table">
            <thead class="thead-light">
            <tr>
                <th scope="col">Number</th>
                <th scope="col">Date</th>
                <th scope="col">Client</th>
                <th scope="col">Total Amount</th>
                <th scope="col">Actions</th>
            </tr>
            </thead>
            <tbody>

            </tbody>
            <tfoot style="border-top-width: thick;border-bottom-width: thick;">
            <tr>
                <td colspan="9"><b>Totals</b></td>
                <td><strong id="active_proposals_total_amount_value"></strong></td>
            </tr>
            </tfoot>
        </table>
    </div>
</div>

<script type="text/javascript">
first_refresh_data_call = true;

function refreshData() {
    if (first_refresh_data_call) {
        $('#loading_modal').modal('hide');
        first_refresh_data_call = false;
    }
<!--    $.ajax({-->
<!--        type: 'GET',-->
<!--        url: '/data',-->
<!--        success: function(data) {            -->
<!--            if (first_refresh_data_call) {-->
<!--                $('#loading_modal').modal('hide');-->
<!--                first_refresh_data_call = false;-->
<!--            }-->
<!--        },-->
<!--        error: function (error) {-->
<!--            if (first_refresh_data_call) {-->
<!--                $('#loading_modal').modal('hide');-->
<!--                first_refresh_data_call = false;-->
<!--            }-->

<!--            if (!connection_lost_dialog_shown) {-->
<!--                notify_warning('Error refreshing data: ' + error);-->
<!--            }-->
<!--        }-->
<!--    });-->
}

$(document).ready(function() {
    $('#loading_modal').modal('show');

    // Call the refreshData function every 1 seconds
    setInterval(refreshData, 1000);
});

function notify_success(message) {
    $('#success_notification_message').html(message);
    $("#success_notification").fadeIn();
    setTimeout(function () {
        $("#success_notification").fadeOut();
    }, 5000);
}

function notify_warning(message) {
    $('#warning_notification_message').html(message);
    $("#warning_notification").fadeIn();
    setTimeout(function () {
        $("#warning_notification").fadeOut();
    }, 5000);
}




</script>

{% endblock %}